<?php
// i18n.php
$cfg = require __DIR__ . '/config.php';
if (session_status() === PHP_SESSION_NONE) {
    session_start();
}

if (isset($_GET['lang']) && isset($cfg['locales'][$_GET['lang']])) {
    $_SESSION['locale'] = $_GET['lang'];
}

$LOCALE = $_SESSION['locale'] ?? $cfg['default_locale'];
$RTL = $cfg['locales'][$LOCALE]['rtl'] ?? false;

function t($key)
{
    global $LOCALE, $STRINGS;
    return $STRINGS[$LOCALE][$key] ?? ($STRINGS['en'][$key] ?? $key);
}

// Minimal UI strings – extend freely
$STRINGS = [
    'en' => [
        'app_title' => 'Book System Management',
        'login' => 'Login',
        'email' => 'Email',
        'password' => 'Password',
        'sign_in' => 'Sign in',
        'logout' => 'Logout',
        'dashboard' => 'Dashboard',
        'books' => 'Books',
        'users' => 'Users',
        'add_book' => 'Add Book',
        'edit_book' => 'Edit Book',
        'delete' => 'Delete',
        'save' => 'Save',
        'cancel' => 'Cancel',
        'title' => 'Title',
        'author' => 'Author',
        'isbn' => 'ISBN',
        'year' => 'Year',
        'language' => 'Language',
        'genre' => 'Genre',
        'tags' => 'Tags',
        'description' => 'Description',
        'actions' => 'Actions',
        'search' => 'Search',
        'filters' => 'Filters',
        'clear' => 'Clear',
        'role' => 'Role',
        'admin' => 'Admin',
        'editor' => 'Editor',
        'viewer' => 'Viewer',
        'name' => 'Name',
        'export' => 'Export',
        'export_csv' => 'CSV',
        'export_xlsx' => 'Excel',
        'export_pdf' => 'PDF',
        'dark_mode' => 'Dark mode',
        'language_ui' => 'UI Language',
    ],
    'ckb' => [
        'app_title' => 'بەڕێوەبردنی کتێبخانە',
        'login' => 'چوونە ژوور',
        'email' => 'ئیمەیل',
        'password' => 'وشەی نهێنی',
        'sign_in' => 'چوونەژوور',
        'logout' => 'دەرچوون',
        'dashboard' => 'داشبۆرد',
        'books' => 'کتێبەکان',
        'users' => 'بەکارهێنەران',
        'add_book' => 'زیادکردنی کتێب',
        'edit_book' => 'دەستکاریکردنی کتێب',
        'delete' => 'سڕینەوە',
        'save' => 'پاشەکەوت',
        'cancel' => 'هەڵوەشاندنەوە',
        'title' => 'ناونیشان',
        'author' => 'نووسەر',
        'isbn' => 'ISBN',
        'year' => 'ساڵ',
        'language' => 'زمان',
        'genre' => 'جۆر',
        'tags' => 'تاگ',
        'description' => 'وەسف',
        'actions' => 'کردارەکان',
        'search' => 'گەڕان',
        'filters' => 'پاڵاوش',
        'clear' => 'پاککردنەوە',
        'role' => 'ڕۆڵ',
        'admin' => 'ئەدمین',
        'editor' => 'دەستکاریکەر',
        'viewer' => 'بینەر',
        'name' => 'ناو',
        'export' => 'هەناردە',
        'export_csv' => 'CSV',
        'export_xlsx' => 'Excel',
        'export_pdf' => 'PDF',
        'dark_mode' => 'دۆخی تاریک',
        'language_ui' => 'زمانی ڕووکاری بەکاربردن',
    ],
    'ar' => [
        'app_title' => 'نظام إدارة الكتب',
        'login' => 'تسجيل الدخول',
        'email' => 'البريد الإلكتروني',
        'password' => 'كلمة المرور',
        'sign_in' => 'دخول',
        'logout' => 'تسجيل الخروج',
        'dashboard' => 'لوحة التحكم',
        'books' => 'الكتب',
        'users' => 'المستخدمون',
        'add_book' => 'إضافة كتاب',
        'edit_book' => 'تعديل كتاب',
        'delete' => 'حذف',
        'save' => 'حفظ',
        'cancel' => 'إلغاء',
        'title' => 'العنوان',
        'author' => 'المؤلف',
        'isbn' => 'ISBN',
        'year' => 'السنة',
        'language' => 'اللغة',
        'genre' => 'النوع',
        'tags' => 'وسوم',
        'description' => 'الوصف',
        'actions' => 'الإجراءات',
        'search' => 'بحث',
        'filters' => 'فلاتر',
        'clear' => 'مسح',
        'role' => 'الدور',
        'admin' => 'مدير',
        'editor' => 'محرر',
        'viewer' => 'عارض',
        'name' => 'الاسم',
        'export' => 'تصدير',
        'export_csv' => 'CSV',
        'export_xlsx' => 'إكسل',
        'export_pdf' => 'PDF',
        'dark_mode' => 'الوضع الداكن',
        'language_ui' => 'لغة الواجهة',
    ],
    'fa' => [
        'app_title' => 'سامانه مدیریت کتاب',
        'login' => 'ورود',
        'email' => 'ایمیل',
        'password' => 'رمز عبور',
        'sign_in' => 'ورود',
        'logout' => 'خروج',
        'dashboard' => 'داشبورد',
        'books' => 'کتاب‌ها',
        'users' => 'کاربران',
        'add_book' => 'افزودن کتاب',
        'edit_book' => 'ویرایش کتاب',
        'delete' => 'حذف',
        'save' => 'ذخیره',
        'cancel' => 'انصراف',
        'title' => 'عنوان',
        'author' => 'نویسنده',
        'isbn' => 'ISBN',
        'year' => 'سال',
        'language' => 'زبان',
        'genre' => 'ژانر',
        'tags' => 'برچسب‌ها',
        'description' => 'توضیحات',
        'actions' => 'اقدامات',
        'search' => 'جستجو',
        'filters' => 'فیلترها',
        'clear' => 'پاک‌سازی',
        'role' => 'نقش',
        'admin' => 'مدیر',
        'editor' => 'ویرایشگر',
        'viewer' => 'بیننده',
        'name' => 'نام',
        'export' => 'خروجی',
        'export_csv' => 'CSV',
        'export_xlsx' => 'اکسل',
        'export_pdf' => 'PDF',
        'dark_mode' => 'حالت تیره',
        'language_ui' => 'زبان رابط',
    ],
    'tr' => [
        'app_title' => 'Kitap Yönetim Sistemi',
        'login' => 'Giriş',
        'email' => 'E‑posta',
        'password' => 'Şifre',
        'sign_in' => 'Giriş yap',
        'logout' => 'Çıkış',
        'dashboard' => 'Panel',
        'books' => 'Kitaplar',
        'users' => 'Kullanıcılar',
        'add_book' => 'Kitap Ekle',
        'edit_book' => 'Kitap Düzenle',
        'delete' => 'Sil',
        'save' => 'Kaydet',
        'cancel' => 'İptal',
        'title' => 'Başlık',
        'author' => 'Yazar',
        'isbn' => 'ISBN',
        'year' => 'Yıl',
        'language' => 'Dil',
        'genre' => 'Tür',
        'tags' => 'Etiketler',
        'description' => 'Açıklama',
        'actions' => 'İşlemler',
        'search' => 'Ara',
        'filters' => 'Filtreler',
        'clear' => 'Temizle',
        'role' => 'Rol',
        'admin' => 'Yönetici',
        'editor' => 'Editör',
        'viewer' => 'Görüntüleyici',
        'name' => 'Ad',
        'export' => 'Dışa aktar',
        'export_csv' => 'CSV',
        'export_xlsx' => 'Excel',
        'export_pdf' => 'PDF',
        'dark_mode' => 'Karanlık mod',
        'language_ui' => 'Arayüz Dili',
    ],
];